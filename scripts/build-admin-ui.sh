#!/bin/bash
##############################################################################
# Admin UI 빌드 스크립트
# 용도: React Admin 앱 빌드
##############################################################################

set -e  # 에러 발생 시 중단

echo "=========================================================================="
echo "🔨 Admin UI 빌드 시작"
echo "=========================================================================="
echo ""

# 작업 디렉토리 이동
cd /home/aigen/admin-api/admin-ui

# Node 버전 확인
echo "📌 Node.js 버전:"
node --version
echo ""

# 의존성 확인
if [ ! -d "node_modules" ]; then
    echo "⚠️ node_modules가 없습니다. npm install 실행..."
    npm install
    echo ""
fi

# 기존 빌드 삭제
if [ -d "dist" ]; then
    echo "🗑️ 기존 빌드 삭제..."
    rm -rf dist
    echo ""
fi

# 빌드 실행
echo "🔨 빌드 실행 중..."
npm run build

# 빌드 결과 확인
echo ""
echo "=========================================================================="
echo "✅ 빌드 완료!"
echo "=========================================================================="
echo ""
echo "📦 빌드 결과:"
ls -lah dist/
echo ""
echo "📄 빌드 파일:"
ls -lah dist/assets/*.js dist/assets/*.css 2>/dev/null || echo "빌드 파일 없음"
echo ""
echo "=========================================================================="
